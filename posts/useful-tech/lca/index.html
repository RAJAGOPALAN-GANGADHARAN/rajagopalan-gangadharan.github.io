<!doctype html><html><head><title>LCA</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/layouts/main.css><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/navigators/navbar.css><link rel=stylesheet href=/css/plyr.css><link href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css><link rel=icon type=image/png href=/images/favicon_hu35d9c722c4a0bf336407cde156644c91_1319_42x0_resize_box_2.png><link rel=stylesheet href=/css/style.css><meta name=description content="LCA explanation in layman terms"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css><link rel=stylesheet href=/css/layouts/single.css><link rel=stylesheet href=/css/navigators/sidebar.css></head><body data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar"><div class=container><a class=navbar-brand href=/><img src=/images/inverted-logo_hu7154849837bf5461fc4f429795573c63_9240_42x0_resize_box_2.png id=logo alt=Logo>Rajagopalan</a>
<button class="navbar-toggler navbar-dark" id=navbar-toggler type=button data-toggle=collapse data-target=#top-nav-items>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=top-nav-items><ul class="navbar-nav ml-auto"><li class=nav-item><a class=nav-link href=https://rajagopalan-gangadharan.github.io/#home>Home</a></li><li class=nav-item><a class=nav-link id=blog-link href=https://rajagopalan-gangadharan.github.io//posts>Posts</a></li><li class=nav-item><a class=nav-link href=https://rajagopalan-gangadharan.github.io/Portfolio/>Interactive</a></li><li class=nav-item><a class=nav-link href=/notes>Notes</a></li><li class=nav-item><a class=nav-link href=/appbox>AppBox</a></li><li class=nav-item><a class=nav-link href=/gh-contrib>Github Contributions</a></li></ul></div></div><img src=/images/main-logo_hu7154849837bf5461fc4f429795573c63_9240_42x0_resize_box_2.png class=d-none id=main-logo alt=Logo>
<img src=/images/inverted-logo_hu7154849837bf5461fc4f429795573c63_9240_42x0_resize_box_2.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=https://rajagopalan-gangadharan.github.io/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts data-filter=all>Posts</a></li><div class=subtree><li><a href=/posts/general/>General</a></li><li><a href=/posts/maths/>Math Tricks</a></li><li><a href=/posts/template-library/>Template Library</a></li><li><a href=/posts/time-complexity/>Time Complexity Analysis</a></li><li><a href=/posts/tutorial-links/>Tutorials</a></li><li><i class="fas fa-plus-circle"></i><a href=/posts/gsoc/>GSoc Blogs</a><ul><li><a href=/posts/gsoc/cw2/>Coding week no 2 and 3</a></li><li><a href=/posts/gsoc/cw1/>Coding week No.1</a></li><li><a href=/posts/gsoc/introduction-copy-4/>Introduction GSoc</a></li><li><a href=/posts/gsoc/mid-com/>Mid Community Bonding--Progress</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/useful-datastructures/>Useful Datastructures</a><ul><li><a href=/posts/useful-datastructures/trees/>Trees</a></li></ul></li><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/useful-tech/>Useful Techniques</a><ul class=active><li><a href=/posts/useful-tech/bellman-ford/>Bellman Ford</a></li><li><a href=/posts/useful-tech/binary-search/>Binary Search</a></li><li><a href=/posts/useful-tech/dfs-order/>DFS - Ordering</a></li><li><a class=active href=/posts/useful-tech/lca/>LCA</a></li><li><a href=/posts/useful-tech/patience-sort/>Patience Sort</a></li><li><a href=/posts/useful-tech/scc/>SCC</a></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(https://rajagopalan-gangadharan.github.io/images/default-hero.jpg)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/default-avatar.png alt="Author Image"><h5 class=author-name>Rajagopalan Gangadharan</h5><p>June 8, 2020</p></div><div class=title><h1>LCA</h1></div><div class=post-content id=post-content><h2 id=lca-using-binary-lifting>LCA Using Binary Lifting</h2><pre><code>k=0 means the parent node
Create a table P[K][N] -&gt; N is number of nodes 
2^k&lt;=N 
So k&lt;=logN 
Hence Size of table is N*logN

jumps are made in order of powers of 2 -&gt;1,2,4...etc
trying to divide by 2 

let mid=par[i][k-1] (2^(k-1)th parent if exists)
par[i][k] is par[mid][k-1] 

Its basically dividing a big jump into 2.


First make 2 nodes that we are going to find LCA to same depth using Walk function
if current jump results -1 then we have jumped of the table.

During LCA jump just close to LCA.
Check if jumping makes them equal if not then make the jump.
Do this until ur able to make a jump.

Finally the answer would be an immediate parent of a node.


Preprocessing is O(NlogN) and per query its O(logN)
Space is O(NlogN)
</code></pre><img src=https://rajagopalan-gangadharan.github.io/Error404/usefultech/LCA1.png alt=lca-explanation width=500px height=500px class=center><div style=margin-top:rem></div><img src=https://rajagopalan-gangadharan.github.io/Error404/usefultech/LCA4.PNG alt=lca-explanation width=500px height=500px class=center><div style=margin-top:rem></div><img src=https://rajagopalan-gangadharan.github.io/Error404/usefultech/LCA2.jpg alt=lca-explanation width=500px height=500px class=center><div style=margin-top:rem></div><img src=https://rajagopalan-gangadharan.github.io/Error404/usefultech/LCA3.jpg alt=lca-explanation width=500px height=500px class=center><div style=margin-top:rem></div><h3 id=do-bfs-for-depth-wrt-to-any-root-node>Do Bfs for depth wrt to any root node</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>bfs</span>(vector<span style=color:#f92672>&amp;</span> adj,vector<span style=color:#f92672>&amp;</span> par,VII<span style=color:#f92672>&amp;</span> depth,<span style=color:#66d9ef>int</span><span style=color:#f92672>&amp;</span> n)
    {
        <span style=color:#75715e>//arbitrarily root the tree
</span><span style=color:#75715e></span>        VII vis(n,false);
        depth[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>;
        vis[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>=</span>true;
        queue q;
        q.push(<span style=color:#ae81ff>0</span>);
        <span style=color:#66d9ef>while</span>(<span style=color:#f92672>!</span>q.empty())
        {
            <span style=color:#66d9ef>int</span> u<span style=color:#f92672>=</span>q.front();
            q.pop();
            <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>auto</span> it:adj[u])
            <span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span>vis[it])
            {
                vis[it]<span style=color:#f92672>=</span>true;
                depth[it]<span style=color:#f92672>=</span>depth[u]<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>;
                par[<span style=color:#ae81ff>0</span>][it]<span style=color:#f92672>=</span>u;
                q.push(it);
            }

        }
    }
</code></pre></div><h3 id=preprocess>Preprocess</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>preprocess</span>(vector<span style=color:#f92672>&lt;</span>VII<span style=color:#f92672>&gt;&amp;</span> par,<span style=color:#66d9ef>int</span><span style=color:#f92672>&amp;</span> n,<span style=color:#66d9ef>int</span><span style=color:#f92672>&amp;</span> D)
{
    <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> d<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>;d<span style=color:#f92672>&lt;=</span>D;<span style=color:#f92672>++</span>d)
    {
        <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> i<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>;i<span style=color:#f92672>&lt;</span>n;<span style=color:#f92672>++</span>i)
        {

            <span style=color:#66d9ef>int</span> mid<span style=color:#f92672>=</span>par[d<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>][i];
            <span style=color:#66d9ef>if</span>(mid<span style=color:#f92672>!=-</span><span style=color:#ae81ff>1</span>)
            par[d][i]<span style=color:#f92672>=</span>par[d<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>][mid];
        }
    }
}
</code></pre></div><h3 id=walk-and-lca>Walk and LCA</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>walk</span>(<span style=color:#66d9ef>int</span> i,<span style=color:#66d9ef>int</span> k,<span style=color:#66d9ef>int</span><span style=color:#f92672>&amp;</span> D,vector<span style=color:#f92672>&lt;</span>VII<span style=color:#f92672>&gt;&amp;</span> par)
{
    <span style=color:#75715e>//To make a node i at depth d
</span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> d<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>;d<span style=color:#f92672>&lt;=</span>D <span style=color:#f92672>&amp;&amp;</span> i<span style=color:#f92672>!=-</span><span style=color:#ae81ff>1</span>;<span style=color:#f92672>++</span>d)
    <span style=color:#66d9ef>if</span>((<span style=color:#ae81ff>1</span><span style=color:#f92672>&lt;&lt;</span>d)<span style=color:#f92672>&amp;</span>k)i<span style=color:#f92672>=</span>par[d][i];

    <span style=color:#66d9ef>return</span> i;
}
<span style=color:#66d9ef>int</span> <span style=color:#a6e22e>LCA</span>(<span style=color:#66d9ef>int</span> a,<span style=color:#66d9ef>int</span> b,vector<span style=color:#f92672>&lt;</span>VII<span style=color:#f92672>&gt;&amp;</span> par,VII<span style=color:#f92672>&amp;</span> depth,<span style=color:#66d9ef>int</span> <span style=color:#f92672>&amp;</span>D)
{
    <span style=color:#66d9ef>if</span>(depth[a]<span style=color:#f92672>&gt;</span>depth[b])
    a<span style=color:#f92672>=</span>walk(a,depth[a]<span style=color:#f92672>-</span>depth[b],D,par);
    <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span>(depth[b]<span style=color:#f92672>&gt;</span>depth[a])
    b<span style=color:#f92672>=</span>walk(b,depth[b]<span style=color:#f92672>-</span>depth[a],D,par);

    <span style=color:#66d9ef>if</span>(a<span style=color:#f92672>==</span>b)
    <span style=color:#66d9ef>return</span> a;

    <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> d<span style=color:#f92672>=</span>D;d<span style=color:#f92672>&gt;=</span><span style=color:#ae81ff>0</span>;<span style=color:#f92672>--</span>d)
    {
        <span style=color:#75715e>//to go close faster make big jumps
</span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span>(par[d][a]<span style=color:#f92672>!=</span>par[d][b])
        {
            a<span style=color:#f92672>=</span>par[d][a];
            b<span style=color:#f92672>=</span>par[d][b];
        }
    }
    <span style=color:#66d9ef>return</span> par[<span style=color:#ae81ff>0</span>][a];
}


<span style=color:#66d9ef>int</span> D<span style=color:#f92672>=</span>log2(n);
</code></pre></div></div><div class=btn-improve-page><a href=https://github.com/RAJAGOPALAN-GANGADHARAN/rajagopalan-gangadharan.github.io/edit/source/content/posts/useful-tech/LCA/index.md target=_blank><i class="fas fa-code-branch"></i>Improve this page</a></div><hr><div class="row next-prev-navigator"><div class="col-md-6 previous-article"><a href=/posts/general/ class="btn btn-outline-info"><div><i class="fas fa-chevron-circle-left"></i>Prev</div><div class=next-prev-text>General facts</div></a></div><div class="col-md-6 next-article"><a href=/posts/maths/ class="btn btn-outline-info"><div>Next <i class="fas fa-chevron-circle-right"></i></div><div class=next-prev-text>Math facts</div></a></div></div><hr><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname=="localhost")return;var dsq=document.createElement("script");dsq.type="text/javascript";dsq.async=true;var disqus_shortname="rajagopalan-gangadharan-github-io";dsq.src="//"+disqus_shortname+".disqus.com/embed.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(dsq);})();</script><noscript>Please enable JavaScript to view the
<a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div></div><a id=scroll-to-top class=btn><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center pl-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ul><li><a href=#lca-using-binary-lifting>LCA Using Binary Lifting</a><ul><li><a href=#do-bfs-for-depth-wrt-to-any-root-node>Do Bfs for depth wrt to any root node</a></li><li><a href=#preprocess>Preprocess</a></li><li><a href=#walk-and-lca>Walk and LCA</a></li></ul></li></ul></nav></div></div></section></div><footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=/#about>About</a></li><li class=nav-item><a class=smooth-scroll href=/#skills>Skills</a></li><li class=nav-item><a class=smooth-scroll href=/#experiences>Experiences</a></li><li class=nav-item><a class=smooth-scroll href=/#education>Education</a></li><li class=nav-item><a class=smooth-scroll href=/#projects>Projects</a></li><li class=nav-item><a class=smooth-scroll href=/#other-experience>Roles and Responsibilities</a></li><li class=nav-item><a class=smooth-scroll href=/#recent-posts>Recent Posts</a></li><li class=nav-item><a class=smooth-scroll href=/#accomplishments>Accomplishments</a></li><li class=nav-item><a class=smooth-scroll href=/#achievements>Memorabilia</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><span>Email:</span> <span>g.raju2000@gmail.com</span></li><li><span>Phone:</span> <span>+91-9941154469</span></li></ul></div><div class="col-md-4 col-sm-12"><p>Stay up to date with email notification</p><form><div class=form-group><input type=email class=form-control id=exampleInputEmail1 aria-describedby=emailHelp placeholder="Enter email">
<small id=emailHelp class="form-text text-muted">We'll never share your email with anyone else.</small></div><button type=submit class="btn btn-info">Submit</button></form></div></div></div><hr><div class=container><div class="col-md-4 text-center">Built with ðŸ§¡ by Rajagopalan</div></div></footer><script type=text/javascript src=/js/jquery-3.4.1.min.js></script><script type=text/javascript src=/js/popper.min.js></script><script type=text/javascript src=/js/bootstrap.min.js></script><script type=text/javascript src=/js/navbar.js></script><script type=text/javascript src=/js/plyr.js></script><script type=text/javascript src=/js/main.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js></script><script src=/js/single.js></script><script>hljs.initHighlightingOnLoad();</script></body></html>